{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the VoicePlan application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "name": {
          "type": "string",
          "description": "User's name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "Plan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Plan",
      "type": "object",
      "description": "Represents a plan generated by the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Plan entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Plan)"
        },
        "title": {
          "type": "string",
          "description": "Title of the plan."
        },
        "description": {
          "type": "string",
          "description": "Description of the plan."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time when the plan was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "description",
        "createdAt"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task within a plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Task entity."
        },
        "planId": {
          "type": "string",
          "description": "Reference to Plan. (Relationship: Plan 1:N Task)"
        },
        "description": {
          "type": "string",
          "description": "Description of the task."
        },
        "dueDate": {
          "type": "string",
          "description": "Due date for the task.",
          "format": "date-time"
        },
        "priority": {
          "type": "number",
          "description": "Priority of the task (e.g., 1 for high, 2 for medium, 3 for low)."
        },
        "completed": {
          "type": "boolean",
          "description": "Indicates whether the task is completed or not."
        }
      },
      "required": [
        "id",
        "planId",
        "description",
        "dueDate",
        "priority",
        "completed"
      ]
    },
    "Reminder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reminder",
      "type": "object",
      "description": "Represents a reminder for a task or plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Reminder entity."
        },
        "taskId": {
          "type": "string",
          "description": "Reference to Task. (Relationship: Task 1:N Reminder)"
        },
        "remindAt": {
          "type": "string",
          "description": "Date and time to send the reminder.",
          "format": "date-time"
        },
        "message": {
          "type": "string",
          "description": "Message to display in the reminder."
        }
      },
      "required": [
        "id",
        "taskId",
        "remindAt",
        "message"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Each document is private to the user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/plans/{planId}",
        "definition": {
          "entityName": "Plan",
          "schema": {
            "$ref": "#/backend/entities/Plan"
          },
          "description": "Stores plans associated with a specific user. Enforces ownership by path.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "planId",
              "description": "The unique identifier of the plan."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/plans/{planId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks within a specific plan. Continues the path-based ownership for secure data access.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "planId",
              "description": "The unique identifier of the plan."
            },
            {
              "name": "taskId",
              "description": "The unique identifier of the task."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/plans/{planId}/tasks/{taskId}/reminders/{reminderId}",
        "definition": {
          "entityName": "Reminder",
          "schema": {
            "$ref": "#/backend/entities/Reminder"
          },
          "description": "Stores reminders for a specific task. Maintains the ownership hierarchy.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "planId",
              "description": "The unique identifier of the plan."
            },
            {
              "name": "taskId",
              "description": "The unique identifier of the task."
            },
            {
              "name": "reminderId",
              "description": "The unique identifier of the reminder."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to securely manage user data, plans, tasks, and reminders for the VoicePlan application. It leverages path-based ownership for private user data, ensuring authorization independence and enabling secure list operations. The structure avoids hierarchical authorization dependencies by nesting entities under their owners (users). This design simplifies security rules and enhances debuggability.\n\n- **/users/{userId}**: Stores user profiles. All documents have the same security requirements (private to the user). Supports QAPs as listing is restricted to the user's own data.\n- **/users/{userId}/plans/{planId}**: Stores plans associated with a specific user. Enforces ownership by path. Supports QAPs by allowing listing only plans owned by the user.\n- **/users/{userId}/plans/{planId}/tasks/{taskId}**: Stores tasks within a specific plan. Continues the path-based ownership for secure data access. Supports QAPs by allowing listing only tasks within plans owned by the user.\n- **/users/{userId}/plans/{planId}/tasks/{taskId}/reminders/{reminderId}**: Stores reminders for a specific task. Maintains the ownership hierarchy. Supports QAPs by restricting listing to reminders associated with tasks within plans owned by the user.\n\nThis structure ensures that all documents within a collection share the same security requirements (Structural Segregation) and that access control is based on path-based ownership (Access Modeling)."
  }
}